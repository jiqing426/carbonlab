# 新闻页面数据需求收集功能

## 概述

在新闻页面（`/news`）中，用户可以通过"提交数据需求"按钮提交个性化的数据需求。该功能实现了基于用户登录状态的智能交互：

- **游客用户**: 点击后显示登录拦截弹窗，提示需要登录
- **已登录用户**: 点击后显示完整的数据需求收集表单

## 功能特性

### 🔐 智能权限控制
- **游客访问**: 自动显示登录拦截弹窗，位于页面右上角
- **登录用户**: 直接显示数据需求收集表单
- **无缝体验**: 根据用户状态自动切换，无需额外操作

### 📝 完整的需求收集
- **基本信息**: 需求标题、数据类型（必填）
- **详细描述**: 具体指标、时间范围、地理范围等（必填）
- **行业分类**: 电力、钢铁、水泥、化工、航空、金融等
- **联系信息**: 邮箱（必填）、电话
- **额外要求**: 其他特殊需求说明

### 🎨 用户友好的界面
- **响应式设计**: 支持桌面端和移动端
- **表单验证**: 必填字段验证，防止无效提交
- **实时反馈**: 提交状态显示，成功/失败提示
- **优雅关闭**: 支持点击遮罩、X按钮、取消按钮关闭

## 技术实现

### 组件架构

#### 1. DataRequirementForm 组件
```tsx
interface DataRequirementFormProps {
  isOpen: boolean;           // 控制表单显示/隐藏
  onClose: () => void;       // 关闭表单回调
}

interface FormData {
  title: string;              // 需求标题
  description: string;        // 详细描述
  dataType: string;          // 数据类型
  industry: string;          // 所属行业
  contactEmail: string;      // 联系邮箱
  contactPhone: string;      // 联系电话
  additionalRequirements: string; // 额外要求
}
```

#### 2. 状态管理
```tsx
// 新闻页面状态
const [showLoginModal, setShowLoginModal] = useState(false)
const [showDataForm, setShowDataForm] = useState(false)
const { isLoggedIn } = useUserStore()

// 表单状态
const [formData, setFormData] = useState<FormData>({...})
const [isSubmitting, setIsSubmitting] = useState(false)
```

#### 3. 智能路由逻辑
```tsx
const handleDataRequirementClick = () => {
  if (isLoggedIn) {
    setShowDataForm(true)        // 已登录：显示表单
  } else {
    setShowLoginModal(true)      // 未登录：显示登录弹窗
  }
}
```

### 表单字段详解

#### 数据类型选项
- **市场数据**: 碳市场价格、交易量等市场信息
- **政策分析**: 政策解读、影响分析等
- **行业报告**: 特定行业的深度研究报告
- **碳排放数据**: 企业、行业碳排放数据
- **交易数据**: 碳配额交易详细数据
- **定制分析**: 根据需求定制的数据分析

#### 行业分类
- **电力行业**: 发电企业碳排放和交易数据
- **钢铁行业**: 钢铁企业碳足迹和减排数据
- **水泥行业**: 水泥企业碳排放分析
- **化工行业**: 化工企业碳管理数据
- **航空行业**: 航空业碳排放和抵消数据
- **金融行业**: 绿色金融、碳金融相关数据
- **其他行业**: 其他未列出的行业



## 用户体验流程

### 游客用户流程
1. 点击"提交数据需求"按钮
2. 右上角显示登录拦截弹窗
3. 弹窗内容："需要登录 - 请先登录后再开始提交数据需求"
4. 用户选择：
   - **我是游客，仅浏览**: 关闭弹窗，继续浏览
   - **立即登录**: 跳转到登录页面

### 已登录用户流程
1. 点击"提交数据需求"按钮
2. 直接显示数据需求收集表单
3. 填写表单信息（必填字段有红色星号标识）
4. 点击"提交需求"按钮
5. 显示提交成功提示："数据需求提交成功！我们的团队将在24小时内与您联系。"
6. 表单自动关闭并重置

## 表单验证规则

### 必填字段
- **需求标题**: 不能为空，建议简洁明了
- **详细描述**: 不能为空，建议详细描述具体需求
- **数据类型**: 必须选择一种数据类型
- **联系邮箱**: 必须是有效的邮箱格式

### 可选字段
- **所属行业**: 可选择或留空
- **联系电话**: 可选择或留空
- **额外要求**: 可选择或留空

## 样式设计

### 弹窗样式
- **位置**: 居中显示，覆盖整个页面
- **尺寸**: 最大宽度4xl，最大高度90vh
- **背景**: 半透明黑色遮罩
- **层级**: z-[9999]，确保在最顶层显示

### 表单样式
- **布局**: 响应式网格布局，移动端单列，桌面端双列
- **间距**: 统一的6单位间距，保持视觉一致性
- **颜色**: 蓝色主题色，与平台整体风格一致
- **交互**: 悬停效果、焦点状态、禁用状态等

### 按钮样式
- **取消按钮**: 轮廓样式，灰色边框
- **提交按钮**: 实心蓝色，悬停时变深
- **状态反馈**: 提交中显示加载动画和"提交中..."文字

## 扩展功能

### 数据持久化
- 可以将表单数据保存到后端数据库
- 支持草稿保存，用户可随时继续编辑
- 历史需求查询和管理

### 智能推荐
- 根据用户历史需求推荐相关数据类型
- 基于行业和紧急程度推荐合适的交付时间
- 智能表单预填充，减少重复输入

### 状态跟踪
- 需求提交后的处理状态跟踪
- 进度通知和更新提醒
- 完成后的满意度评价

## 测试验证

### 功能测试
1. **游客模式**: 点击按钮显示登录弹窗
2. **登录模式**: 点击按钮显示数据表单
3. **表单验证**: 必填字段验证是否正常工作
4. **提交流程**: 模拟提交是否成功
5. **弹窗关闭**: 各种关闭方式是否正常

### 用户体验测试
1. **响应式设计**: 在不同设备上的显示效果
2. **表单填写**: 表单是否易于填写和理解
3. **错误处理**: 验证失败时的提示是否清晰
4. **成功反馈**: 提交成功后的提示是否友好

## 维护说明

### 修改表单字段
如需添加或修改表单字段，请编辑 `components/news/DataRequirementForm.tsx` 文件中的：
- `FormData` 接口
- 表单UI组件
- 验证逻辑
- 提交处理

### 修改权限逻辑
如需调整权限控制逻辑，请编辑 `app/news/page.tsx` 文件中的：
- `handleDataRequirementClick` 函数
- 状态管理逻辑
- 弹窗显示条件

### 样式定制
如需修改样式，请编辑相应组件中的Tailwind CSS类，保持与平台整体设计风格一致。
